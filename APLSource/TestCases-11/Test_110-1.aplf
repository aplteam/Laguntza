 R←Test_110(stopFlag batchFlag);⎕TRAP;ps;ref;sa;lines;names;seachFor
⍝ Exercise full-text "word" search. See Test_126 for a "Search as is" test.
⍝ R gets one of: 0=Okay, 1=test case failed, ¯1=test case was not executed due to the "batchFlag"
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')
 R←∆Failed

 ps←##.Markdown2Help.CreateParms ⍬
 ps.helpCaption←'TestCases'
 ps.folderName←GetPathForTempHelpProject'Test_110'
 ps.source←#._Markdown2Help.TestCases.TestCase_110_Data
 ps.visible←0
 ps.reportToSession←0
 ref←1 ##.Markdown2Help.New ps
 ref.⎕WS'Event' 9955 1
 ∆Process ref

 sa←1                     ⍝ 1: Ignore container in search
 sa,←⊂'and'               ⍝ 2: Search string
 sa,←1                    ⍝ 3: "full text search" flag
 sa,←1                    ⍝ 4: lower case flag
 sa,←1                    ⍝ 5: Match whole words only
 sa,←0                    ⍝ 6: Search "As is" flag
 (lines names)←ref ##.Markdown2Help.Search.Search sa ⍝ Perform the search
 →GoToTidyUp'Layout' 'Page1' 'Sub1/Page2'≢names

 sa←1                     ⍝ 1: Ignore container in search
 sa,←⊂'results'           ⍝ 2: Search string
 sa,←1                    ⍝ 3: full text search
 sa,←0                    ⍝ 4: lower case flag
 sa,←1                    ⍝ 5: Match whole words only
 sa,←0                    ⍝ 6: Search "As is" flag
 (lines names)←ref ##.Markdown2Help.Search.Search sa ⍝ Perform the search
 →GoToTidyUp(,⊂'Layout')≢names

 sa←1                     ⍝ 1: Ignore container in search
 sa,←⊂'results'               ⍝ 2: Search string
 sa,←1                    ⍝ 3: full text search
 sa,←1                    ⍝ 4: lower case flag
 sa,←1                    ⍝ 5: Match whole words only
 sa,←0                    ⍝ 6: Search "As is" flag
 (lines names)←ref ##.Markdown2Help.Search.Search sa ⍝ Perform the search
 →GoToTidyUp('Layout' 'Overview')≢names

 sa←1                     ⍝ 1: Ignore container in search
 sa,←⊂'activeX'           ⍝ 2: Search string
 sa,←1                    ⍝ 3: full text search
 sa,←0                    ⍝ 4: lower case flag
 sa,←1                    ⍝ 5: Match whole words only
 sa,←0                    ⍝ 6: Search "As is" flag
 (lines names)←ref ##.Markdown2Help.Search.Search sa ⍝ Perform the search
 →GoToTidyUp~0∊⍴names

 sa←1                     ⍝ 1: Ignore container in search
 sa,←⊂'ActiveX'           ⍝ 2: Search string
 sa,←1                    ⍝ 3: full text search
 sa,←0                    ⍝ 4: lower case flag
 sa,←1                    ⍝ 5: Match whole words only
 sa,←0                    ⍝ 6: Search "As is" flag
 (lines names)←ref ##.Markdown2Help.Search.Search sa ⍝ Perform the search
 →GoToTidyUp(,⊂'Overview')≢names

 sa←1                     ⍝ 1: Ignore container in search
 sa,←⊂'ea of APLTree'     ⍝ 2: Search string
 sa,←1                    ⍝ 3: full text search
 sa,←1                    ⍝ 4: lower case flag
 sa,←1                    ⍝ 5: Match whole words only
 sa,←0                    ⍝ 6: Search "As is" flag
 (lines names)←ref ##.Markdown2Help.Search.Search sa ⍝ Perform the search
 →GoToTidyUp~0∊⍴lines
 →GoToTidyUp~0∊⍴names

 R←∆OK

∆TidyUp:
 ##.Markdown2Help.Reset
