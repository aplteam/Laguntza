 R←Test_ViewHelp_03(stopFlag batchFlag);⎕TRAP;ref;report;path;tempPath;rc;processInfo;result;more;parms;pid;flag;myZipper;success
⍝ Test whether image shows or not. Was once a bug.
⍝ R gets one of: 0=Okay, 1=test case failed, ¯1=test case was not executed due to the "batchFlag"
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')

 :If batchFlag
     R←∆NoBatchTest
     :Return
 :EndIf

 R←∆Failed

 path←#.FilesAndDirs.NormalizePath #.FilesAndDirs.PWD,'\Dest\'
 tempPath←#.FilesAndDirs.GetTempFilename''
 #.FilesAndDirs.DeleteFile tempPath
 tempPath←¯4↓tempPath
 success←'Create!'#.FilesAndDirs.CheckPath tempPath
 'Something went terribly wrong'Assert success

 myZipper←⎕NEW #.SevenZip(,⊂path,'Markdown2Help.zip')
 rc←myZipper.Unzip tempPath
 'Something went terribly wrong'Assert 0=↑rc
 'Create!'#.FilesAndDirs.CheckPath tempPath,'/help/files/Images'
 (#.FilesAndDirs.PWD,'\FlipDB-Team.png')#.FilesAndDirs.CopyTo tempPath,'/help/files/Images/'

 parms←#.Execute.DefaultParms
 parms.wait←0
 (rc processInfo result more)←parms #.Execute.Application tempPath,'/help/ViewHelp.exe page="Images"'
 'Something went terribly wrong'Assert 0=↑rc
 pid←2⊃processInfo

 R←~∆YesOrNo'Does the image "FlipDB-Team" show up?'
 {}#.OS.KillPID pid

∆TidyUp:
 #.FilesAndDirs.DeleteFile tempPath
