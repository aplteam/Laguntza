 R←Test_109(stopFlag batchFlag);⎕TRAP;txt;ps;ref;txt2
⍝ Exercise the "RemoveLinksFromText" method
⍝ R gets one of: 0=Okay, 1=test case failed, ¯1=test case was not executed due to the "batchFlag"
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')
 R←∆Failed

 ps←##.Markdown2Help.CreateParms ⍬
 ps.helpCaption←'TestCases'
 ps.folderName←GetPathForTempHelpProject'Test_109'
 ps.source←##.Markdown2Help.HelpHelp
 ps.visible←0
 ref←1 ##.Markdown2Help.New ps
 ref.⎕WS'Event' 9955 1
 ∆Process ref

 →GoToTidyUp~''≡##.Markdown2Help.RemoveLinksFromText''

 txt←'This pretends to be a paragraph with a relativ →[Link] in it.'
 →GoToTidyUp~∨/' relativ Link in '⍷##.Markdown2Help.RemoveLinksFromText txt

 txt←'This pretends to be a paragraph with a relativ →[Links] in it.'
 →GoToTidyUp~∨/' relativ Links in '⍷##.Markdown2Help.RemoveLinksFromText txt

 txt←'This pretends to be a paragraph with a relativ →[Link_to_Page] in it.'
 →GoToTidyUp~∨/' relativ Link to Page in '⍷##.Markdown2Help.RemoveLinksFromText txt

 txt←'Paragraph with a Link →[topicName|alternative link text] for testing purposes.'
 →GoToTidyUp~∨/'Link alternative link text for '⍷##.Markdown2Help.RemoveLinksFromText txt

 txt←'Paragraph with a Link →[topicName|link text] for testing purposes.'
 →GoToTidyUp~∨/' Link link text for '⍷##.Markdown2Help.RemoveLinksFromText txt

 txt←'Paragraph with a Link `→[topicName|link text]` for testing purposes.'
 →GoToTidyUp~∨/' Link `link text` for'⍷##.Markdown2Help.RemoveLinksFromText txt

 txt←'Paragraph with a Link →[*.Some_topic] for testing purposes.'
 →GoToTidyUp~∨/' Link Some topic for '⍷##.Markdown2Help.RemoveLinksFromText txt

 txt←'Paragraph with a Link →[*Some_topic] for testing purposes.'
 →GoToTidyUp~∨/' Link Some topic for '⍷##.Markdown2Help.RemoveLinksFromText txt

 txt←'Paragraph with a Link →[↑*Some_topic] for testing purposes.'
 →GoToTidyUp~∨/' Link Some topic for '⍷##.Markdown2Help.RemoveLinksFromText txt

 txt←'Paragraph with a Link →[↑*.Some_topic] for testing purposes.'
 →GoToTidyUp~∨/' Link Some topic for '⍷##.Markdown2Help.RemoveLinksFromText txt

 txt←'Paragraph with a Link →[topicName |  alternative link text  ] for testing purposes.'
 →GoToTidyUp~∨/' Link alternative link text for '⍷##.Markdown2Help.RemoveLinksFromText txt

 txt←'Paragraph with a Link →[##.Markdown2Help.HelpHelp.Misc.Names_and_Conventions] for testing purposes.'
 →GoToTidyUp~∨/' Link Names and Conventions for '⍷##.Markdown2Help.RemoveLinksFromText txt

 txt←'Paragraph with a Link →[Misc.Names_and_Conventions] for testing purposes.'
 →GoToTidyUp~∨/' Link Names and Conventions for '⍷##.Markdown2Help.RemoveLinksFromText txt

 txt←'Paragraph with a Link →[##.##.Misc.Names_and_Conventions] for testing purposes.'
 →GoToTidyUp~∨/' Link Names and Conventions for '⍷##.Markdown2Help.RemoveLinksFromText txt

 txt←'This pretends to be a paragraph with several →[*.SeeAlso_Links] in all different'
 txt,←' Flavours →[topicName1] including `→[topicName2|Topic ID with an alternative link text]`'
 txt,←' useful useful for testing purposes.'

 txt2←'This pretends to be a paragraph with several SeeAlso Links in all different'
 txt2,←' Flavours topicName1 including `Topic ID with an alternative link text`'
 txt2,←' useful useful for testing purposes.'
 →GoToTidyUp~txt2≡##.Markdown2Help.RemoveLinksFromText txt

 R←∆OK

∆TidyUp:
 ##.Markdown2Help.Reset
